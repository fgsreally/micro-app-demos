{"version":3,"file":"CoexistMicroApp.0ee1b44d.js","sources":["../../../../node_modules/.pnpm/ant-design-vue@3.2.20_vue@3.3.4/node_modules/ant-design-vue/es/alert/index.js","../../../../packages/merak-demo/vue3-main/src/views/CoexistMicroApp.vue"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { withDirectives as _withDirectives, vShow as _vShow, createVNode as _createVNode } from \"vue\";\nimport { defineComponent, ref } from 'vue';\nimport CloseOutlined from \"@ant-design/icons-vue/es/icons/CloseOutlined\";\nimport CheckCircleOutlined from \"@ant-design/icons-vue/es/icons/CheckCircleOutlined\";\nimport ExclamationCircleOutlined from \"@ant-design/icons-vue/es/icons/ExclamationCircleOutlined\";\nimport InfoCircleOutlined from \"@ant-design/icons-vue/es/icons/InfoCircleOutlined\";\nimport CloseCircleOutlined from \"@ant-design/icons-vue/es/icons/CloseCircleOutlined\";\nimport CheckCircleFilled from \"@ant-design/icons-vue/es/icons/CheckCircleFilled\";\nimport ExclamationCircleFilled from \"@ant-design/icons-vue/es/icons/ExclamationCircleFilled\";\nimport InfoCircleFilled from \"@ant-design/icons-vue/es/icons/InfoCircleFilled\";\nimport CloseCircleFilled from \"@ant-design/icons-vue/es/icons/CloseCircleFilled\";\nimport classNames from '../_util/classNames';\nimport PropTypes from '../_util/vue-types';\nimport { getTransitionProps, Transition } from '../_util/transition';\nimport { isValidElement, getPropsSlot } from '../_util/props-util';\nimport { tuple, withInstall } from '../_util/type';\nimport { cloneElement } from '../_util/vnode';\nimport useConfigInject from '../_util/hooks/useConfigInject';\nvar iconMapFilled = {\n  success: CheckCircleFilled,\n  info: InfoCircleFilled,\n  error: CloseCircleFilled,\n  warning: ExclamationCircleFilled\n};\nvar iconMapOutlined = {\n  success: CheckCircleOutlined,\n  info: InfoCircleOutlined,\n  error: CloseCircleOutlined,\n  warning: ExclamationCircleOutlined\n};\nvar AlertTypes = tuple('success', 'info', 'warning', 'error');\nexport var alertProps = function alertProps() {\n  return {\n    /**\n     * Type of Alert styles, options: `success`, `info`, `warning`, `error`\n     */\n    type: PropTypes.oneOf(AlertTypes),\n    /** Whether Alert can be closed */\n    closable: {\n      type: Boolean,\n      default: undefined\n    },\n    /** Close text to show */\n    closeText: PropTypes.any,\n    /** Content of Alert */\n    message: PropTypes.any,\n    /** Additional content of Alert */\n    description: PropTypes.any,\n    /** Trigger when animation ending of Alert */\n    afterClose: Function,\n    /** Whether to show icon */\n    showIcon: {\n      type: Boolean,\n      default: undefined\n    },\n    prefixCls: String,\n    banner: {\n      type: Boolean,\n      default: undefined\n    },\n    icon: PropTypes.any,\n    closeIcon: PropTypes.any,\n    onClose: Function\n  };\n};\nvar Alert = defineComponent({\n  compatConfig: {\n    MODE: 3\n  },\n  name: 'AAlert',\n  inheritAttrs: false,\n  props: alertProps(),\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots,\n      emit = _ref.emit,\n      attrs = _ref.attrs,\n      expose = _ref.expose;\n    var _useConfigInject = useConfigInject('alert', props),\n      prefixCls = _useConfigInject.prefixCls,\n      direction = _useConfigInject.direction;\n    var closing = ref(false);\n    var closed = ref(false);\n    var alertNode = ref();\n    var handleClose = function handleClose(e) {\n      e.preventDefault();\n      var dom = alertNode.value;\n      dom.style.height = \"\".concat(dom.offsetHeight, \"px\");\n      // Magic code\n      // 重复一次后才能正确设置 height\n      dom.style.height = \"\".concat(dom.offsetHeight, \"px\");\n      closing.value = true;\n      emit('close', e);\n    };\n    var animationEnd = function animationEnd() {\n      var _props$afterClose;\n      closing.value = false;\n      closed.value = true;\n      (_props$afterClose = props.afterClose) === null || _props$afterClose === void 0 ? void 0 : _props$afterClose.call(props);\n    };\n    expose({\n      animationEnd: animationEnd\n    });\n    var motionStyle = ref({});\n    return function () {\n      var _slots$closeIcon, _classNames;\n      var banner = props.banner,\n        _props$closeIcon = props.closeIcon,\n        customCloseIcon = _props$closeIcon === void 0 ? (_slots$closeIcon = slots.closeIcon) === null || _slots$closeIcon === void 0 ? void 0 : _slots$closeIcon.call(slots) : _props$closeIcon;\n      var closable = props.closable,\n        type = props.type,\n        showIcon = props.showIcon;\n      var closeText = getPropsSlot(slots, props, 'closeText');\n      var description = getPropsSlot(slots, props, 'description');\n      var message = getPropsSlot(slots, props, 'message');\n      var icon = getPropsSlot(slots, props, 'icon');\n      // banner模式默认有 Icon\n      showIcon = banner && showIcon === undefined ? true : showIcon;\n      // banner模式默认为警告\n      type = banner && type === undefined ? 'warning' : type || 'info';\n      var IconType = (description ? iconMapOutlined : iconMapFilled)[type] || null;\n      // closeable when closeText is assigned\n      if (closeText) {\n        closable = true;\n      }\n      var prefixClsValue = prefixCls.value;\n      var alertCls = classNames(prefixClsValue, (_classNames = {}, _defineProperty(_classNames, \"\".concat(prefixClsValue, \"-\").concat(type), true), _defineProperty(_classNames, \"\".concat(prefixClsValue, \"-closing\"), closing.value), _defineProperty(_classNames, \"\".concat(prefixClsValue, \"-with-description\"), !!description), _defineProperty(_classNames, \"\".concat(prefixClsValue, \"-no-icon\"), !showIcon), _defineProperty(_classNames, \"\".concat(prefixClsValue, \"-banner\"), !!banner), _defineProperty(_classNames, \"\".concat(prefixClsValue, \"-closable\"), closable), _defineProperty(_classNames, \"\".concat(prefixClsValue, \"-rtl\"), direction.value === 'rtl'), _classNames));\n      var closeIcon = closable ? _createVNode(\"button\", {\n        \"type\": \"button\",\n        \"onClick\": handleClose,\n        \"class\": \"\".concat(prefixClsValue, \"-close-icon\"),\n        \"tabindex\": 0\n      }, [closeText ? _createVNode(\"span\", {\n        \"class\": \"\".concat(prefixClsValue, \"-close-text\")\n      }, [closeText]) : customCloseIcon === undefined ? _createVNode(CloseOutlined, null, null) : customCloseIcon]) : null;\n      var iconNode = icon && (isValidElement(icon) ? cloneElement(icon, {\n        class: \"\".concat(prefixClsValue, \"-icon\")\n      }) : _createVNode(\"span\", {\n        \"class\": \"\".concat(prefixClsValue, \"-icon\")\n      }, [icon])) || _createVNode(IconType, {\n        \"class\": \"\".concat(prefixClsValue, \"-icon\")\n      }, null);\n      var transitionProps = getTransitionProps(\"\".concat(prefixClsValue, \"-motion\"), {\n        appear: false,\n        css: true,\n        onAfterLeave: animationEnd,\n        onBeforeLeave: function onBeforeLeave(node) {\n          node.style.maxHeight = \"\".concat(node.offsetHeight, \"px\");\n        },\n        onLeave: function onLeave(node) {\n          node.style.maxHeight = '0px';\n        }\n      });\n      return closed.value ? null : _createVNode(Transition, transitionProps, {\n        default: function _default() {\n          return [_withDirectives(_createVNode(\"div\", _objectSpread(_objectSpread({\n            \"role\": \"alert\"\n          }, attrs), {}, {\n            \"style\": [attrs.style, motionStyle.value],\n            \"class\": [attrs.class, alertCls],\n            \"data-show\": !closing.value,\n            \"ref\": alertNode\n          }), [showIcon ? iconNode : null, _createVNode(\"div\", {\n            \"class\": \"\".concat(prefixClsValue, \"-content\")\n          }, [message ? _createVNode(\"div\", {\n            \"class\": \"\".concat(prefixClsValue, \"-message\")\n          }, [message]) : null, description ? _createVNode(\"div\", {\n            \"class\": \"\".concat(prefixClsValue, \"-description\")\n          }, [description]) : null]), closeIcon]), [[_vShow, !closing.value]])];\n        }\n      });\n    };\n  }\n});\nexport default withInstall(Alert);","<template>\n  <a-space direction=\"vertical\" :size=\"40\" class=\"box\">\n    <a-alert\n      message=\"左上侧应用为Vue2子应用，右上侧应用为React18子应用，左下侧为vite子应用。\"\n      type=\"success\"\n    />\n    <a-row :gutter=\"20\">\n      <a-col :span=\"12\">\n        <a-button\n          v-if=\"showVue2App\"\n          type=\"primary\"\n          danger\n          @click=\"toggleVue2AppShow\"\n        >\n          卸载Vue2应用\n        </a-button>\n        <a-button v-else type=\"primary\" @click=\"toggleVue2AppShow\">\n          加载Vue2应用\n        </a-button>\n        <merak-vue2\n          v-if=\"showVue2App && vue2App\"\n          class=\"app\"\n          routePath=\"/\"\n          :afterMount=\"afterMount\"\n        />\n      </a-col>\n      <a-col :span=\"12\">\n        <a-button\n          v-if=\"showReactApp\"\n          type=\"primary\"\n          danger\n          @click=\"toggleReactAppShow\"\n        >\n          卸载React18应用\n        </a-button>\n        <a-button v-else type=\"primary\" @click=\"toggleReactAppShow\">\n          加载React18应用\n        </a-button>\n        <merak-react\n          v-if=\"showReactApp && reactApp\"\n          class=\"app\"\n          routePath=\"/\"\n          :afterMount=\"afterMount\"\n        />\n      </a-col>\n      <a-col :span=\"12\">\n        <a-button\n          v-if=\"showReactApp\"\n          type=\"primary\"\n          danger\n          @click=\"toggleViteAppShow\"\n        >\n          卸载Vite应用\n        </a-button>\n        <a-button v-else type=\"primary\" @click=\"toggleViteAppShow\">\n          加载Vite应用\n        </a-button>\n        <merak-vite\n          v-if=\"showViteApp && viteApp\"\n          class=\"app\"\n          routePath=\"/\"\n          :afterMount=\"afterMount\"\n        />\n      </a-col>\n    </a-row>\n  </a-space>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  name: 'CoexistMicroApp'\n}\n</script>\n\n<script lang=\"ts\" setup>\nimport { useAppStore } from '@/stores/app'\nimport { storeToRefs } from 'pinia'\nimport { ref, toRaw, watch } from 'vue'\nimport type { MicroApp } from '@/data/appData'\nimport { useUserStore } from '@/stores/user'\nimport { $$namespace } from 'merak-vue'\nimport MerakVue2 from './merak/Vue2.vue'\nimport MerakReact from './merak/React.vue'\nimport MerakVite from './merak/Vite.vue'\n\nconst vue2App = ref<MicroApp | null>(null)\nconst reactApp = ref<MicroApp | null>(null)\nconst viteApp = ref<MicroApp | null>(null)\nconst showVue2App = ref(true)\nconst showReactApp = ref(true)\nconst showViteApp = ref(true)\n\nconst { apps } = storeToRefs(useAppStore())\nconst { user } = storeToRefs(useUserStore())\n\nwatch(\n  apps.value,\n  (newApp) => {\n    newApp.forEach((item) => {\n      if (item.name === 'vue2App') {\n        vue2App.value = item\n      } else if (item.name === 'reactApp') {\n        reactApp.value = item\n      } else if (item.name === 'viteApp') {\n        viteApp.value = item\n      }\n    })\n  },\n  {\n    immediate: true\n  }\n)\n\nasync function afterMount() {\n  $$namespace('emitter').emit('changeUser', {\n    user: toRaw(user.value)\n  })\n}\n\nfunction toggleVue2AppShow() {\n  showVue2App.value = !showVue2App.value\n}\n\nfunction toggleReactAppShow() {\n  showReactApp.value = !showReactApp.value\n}\n\nfunction toggleViteAppShow() {\n  showViteApp.value = !showViteApp.value\n}\n</script>\n\n<style lang=\"less\" scoped>\n.box {\n  width: 100%;\n}\n\n.app {\n  margin-top: 20px;\n}\n</style>\n"],"names":["iconMapFilled","CheckCircleFilled","InfoCircleFilled","CloseCircleFilled","ExclamationCircleFilled","iconMapOutlined","CheckCircleOutlined","InfoCircleOutlined","CloseCircleOutlined","ExclamationCircleOutlined","AlertTypes","tuple","alertProps","PropTypes","Alert","defineComponent","props","_ref","slots","emit","attrs","expose","_useConfigInject","useConfigInject","prefixCls","direction","closing","ref","closed","alertNode","handleClose","dom","animationEnd","_props$afterClose","motionStyle","_slots$closeIcon","_classNames","banner","_props$closeIcon","customCloseIcon","closable","type","showIcon","closeText","getPropsSlot","description","message","icon","IconType","prefixClsValue","alertCls","classNames","_defineProperty","closeIcon","_createVNode","CloseOutlined","iconNode","isValidElement","cloneElement","transitionProps","getTransitionProps","node","Transition","_withDirectives","_objectSpread","_vShow","__unplugin_components_0","withInstall","__default__","vue2App","reactApp","viteApp","showVue2App","showReactApp","showViteApp","apps","storeToRefs","useAppStore","user","useUserStore","watch","newApp","item","afterMount","$$namespace","toRaw","toggleVue2AppShow","toggleReactAppShow","toggleViteAppShow"],"mappings":"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"}